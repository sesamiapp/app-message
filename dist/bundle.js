(()=>{"use strict";var t,n;!function(t){t.INIT="INIT",t.TOKEN="TOKEN",t.NEXT="NEXT"}(t||(t={})),function(t){t.ADMIN_APP="ADMIN_APP",t.EXPERIENCE_INSTANT_BOOKING="EXPERIENCE_INSTANT_BOOKING"}(n||(n={}));var e=function(n){var e,i={action:t.TOKEN,payload:{clientId:n}};return null===(e=window.top)||void 0===e||e.postMessage(i),new Promise((function(n){window.addEventListener(t.TOKEN,(function(t){n(t.detail.event.data.payload.token)}))}))},i=function(){var n,e={action:t.INIT};return null===(n=window.top)||void 0===n||n.postMessage(e),new Promise((function(n){window.addEventListener(t.INIT,(function(t){n(t.detail.event.data.payload)}))}))},o=function(t){try{var n=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),e=decodeURIComponent(window.atob(n).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(e)}catch(t){return null}},r=function(t){var n=new Date;return!(1e3*(function(t){var n=o(t)||null;return n?n.exp:0}(t)-30)>n.getTime())},a=function(){window.onmessage||(window.onmessage=function(t){window.dispatchEvent(new CustomEvent(t.data.action,{detail:{event:t}}))})},u=function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{c(i.next(t))}catch(t){r(t)}}function u(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}c((i=i.apply(t,n||[])).next())}))},c=function(t,n){var e,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(c){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(a=0)),a;)try{if(e=1,i&&(o=2&u[0]?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,i=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=n.call(t,a)}catch(t){u=[6,t],i=0}finally{e=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},l=(function(){function t(t,n,i,o){var a=this;this.environment=null,this.token=null,this.getEnvironment=function(){return a.environment},this.getShopId=function(){return a.shopId},this.getLocale=function(){return a.locale},this.getToken=function(){return u(a,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return!this.token||r(this.token)?[3,1]:[2,this.token];case 1:return[4,e(this.clientId)];case 2:return t=n.sent(),this.token=t,[2,t]}}))}))},this.clientId=t,this.environment=n,this.shopId=i,this.locale=o}var n;n=t,t.init=function(t){return u(void 0,void 0,void 0,(function(){var e;return c(n,(function(o){switch(o.label){case 0:return a(),[4,i()];case 1:return e=o.sent(),[2,new n(t,e.environment,e.shopId,e.locale)]}}))}))}}(),function(n){window.addEventListener(t.NEXT,(function(){return n()}))}),s=function(){var n,e={action:t.NEXT,payload:{isAccepted:!0}};null===(n=window.top)||void 0===n||n.postMessage(e)},f=function(){var n,e={action:t.NEXT,payload:{isAccepted:!1}};null===(n=window.top)||void 0===n||n.postMessage(e)};!function(){function t(t,n,e,i,o,r,a,u){var c=this;this.environment=null,this.productId=null,this.variantId=null,this.quantity=null,this.teamMember=null,this.slot=null,this.getEnvironment=function(){return c.environment},this.getShopId=function(){return c.shopId},this.getLocale=function(){return c.locale},this.getProductId=function(){return c.productId},this.getVariantId=function(){return c.variantId},this.getQuantity=function(){return c.quantity},this.getTeamMember=function(){return c.teamMember},this.getSlot=function(){return c.slot},this.onNext=l,this.acceptNext=s,this.rejectNext=f,this.environment=t,this.shopId=n,this.locale=e,i&&(this.productId=i),o&&(this.variantId=o),r&&(this.quantity=r),a&&(this.teamMember=a),u&&(this.slot=u)}var n;n=t,t.init=function(){return t=void 0,e=void 0,r=function(){var t;return function(t,n){var e,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(c){return function(u){if(e)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(a=0)),a;)try{if(e=1,i&&(o=2&u[0]?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,i=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=n.call(t,a)}catch(t){u=[6,t],i=0}finally{e=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}(n,(function(e){switch(e.label){case 0:return a(),[4,i()];case 1:return t=e.sent(),[2,new n(t.environment,t.shopId,t.locale,t.productId,t.variantId,t.quantity,t.teamMember,t.slot)]}}))},new((o=void 0)||(o=Promise))((function(n,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}));var t,e,o,r}}()})();