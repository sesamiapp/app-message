{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/types/action.type.ts","../src/types/environment.type.ts","../src/types/message.type.ts","../src/types/team-member.type.ts","../src/types/token.type.ts","../src/types/index.ts","../src/app/authentication.app.ts","../src/app/events.app.ts","../src/app/init.app.ts","../src/utils/listener.ts","../src/utils/parse-jwt-token.ts","../src/utils/is-token-expired.ts","../src/utils/index.ts","../src/app/sesami-admin.ts","../src/app/sesami-experience.ts","../src/app/index.ts","../src/host/events.host.ts","../src/host/init.host.ts","../src/host/authentication.host.ts","../src/host/app-admin.ts","../src/host/app-experience.ts","../src/host/index.ts"],"names":[],"mappings":"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","sourcesContent":["export enum Action {\n    INIT = 'INIT',\n    TOKEN = 'TOKEN',\n    NEXT = 'NEXT',\n}\n","export enum Environment {\n    ADMIN_APP = 'ADMIN_APP',\n    EXPERIENCE_INSTANT_BOOKING = 'EXPERIENCE_INSTANT_BOOKING'\n}\n","import { Action } from './action.type'\n\n//todo: specify all payloads to their actions\n\nexport type Message = {\n    action: Action,\n    token?: string,\n    payload?: any\n}\n\n","export type TeamMember = {\n    id: string\n    name: string\n    image: string\n    description: string | null\n}\n","export type AccessToken = {\n    userId: string\n    clientId: string\n    email: string\n    exp: number\n    iat: number\n}\n","export * from './action.type'\nexport * from './environment.type'\nexport * from './message.type'\nexport * from './team-member.type'\nexport * from './token.type'\n","import { Action, Message } from '../types'\n\nexport const getToken = (clientId: string) => {\n    const data: Message = {\n        action: Action.TOKEN,\n        payload: {\n            clientId\n        }\n    }\n    window.top?.postMessage(data)\n    return new Promise(resolve => {\n        window.addEventListener(Action.TOKEN, (e: any) => {\n            resolve(e.detail.event.data.payload.token)\n        })\n    })\n}\n","import { Action, Message } from '../types'\n\nexport const onNext = (callback: () => void) => {\n    window.addEventListener(Action.NEXT, () => callback())\n}\n\nexport const acceptNext = () => {\n    const data: Message = {\n        action: Action.NEXT,\n        payload: {\n            isAccepted: true\n        }\n    }\n    window.top?.postMessage(data)\n}\n\nexport const rejectNext = () => {\n    const data: Message = {\n        action: Action.NEXT,\n        payload: {\n            isAccepted: false\n        }\n    }\n    window.top?.postMessage(data)\n}\n","import { Action, Message } from '../types'\n\nexport const getInit = () => {\n    const data: Message = {\n        action: Action.INIT\n    }\n    window.top?.postMessage(data)\n    return new Promise(resolve => {\n        window.addEventListener(Action.INIT, (e: any) => {\n            resolve(e.detail.event.data.payload)\n        })\n    })\n}\n","export const initListener = () => {\n    if(!window.onmessage){\n        window.onmessage = (event: MessageEvent<any>) => {\n            window.dispatchEvent(new CustomEvent(event.data.action, {\n                detail: { //todo: can remove details?\n                    event\n                }\n            }))\n        }\n    }\n}\n","import { AccessToken } from '../types'\n\nexport const getTokenExpiration = (token: string) => {\n    const jwtParsed = <AccessToken>parseJwtToken(token)\n    if(jwtParsed){\n        return jwtParsed.exp\n    }else{\n        return 0\n    }\n}\n\nconst parseJwtToken = <T>(refreshToken: string) => {\n    const parsedJWT = parseJWT(refreshToken)\n    if(parsedJWT){\n        return parsedJWT as T\n    }else{\n        return null\n    }\n}\n\nconst parseJWT = (token: string) => {\n    try{\n        const base64Url = token.split('.')[1]\n        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/')\n        const jsonPayload = decodeURIComponent(window.atob(base64).split('').map(c => (\n            '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)\n        )).join(''))\n        return JSON.parse(jsonPayload)\n    }catch{\n        return null\n    }\n}\n","import { getTokenExpiration } from './parse-jwt-token'\n\nexport const isTokenExpired = (token: string) => {\n    const now = new Date()\n    if((getTokenExpiration(token) - 30)*1000 > now.getTime()){ // 30 seconds offset\n        return false\n    }else{\n        return true\n    }\n}\n","export * from './listener'\nexport * from './parse-jwt-token'\nexport * from './is-token-expired'\n","import { getToken } from './authentication.app'\nimport { getInit } from './init.app'\nimport { Environment } from '../types'\nimport { initListener, isTokenExpired } from '../utils'\n\nexport class SesamiAdmin {\n\n    private clientId: string\n    private environment: Environment | null = null\n    private shopId: string\n    private locale: string\n    private token: string | null = null\n\n    getEnvironment = () => this.environment\n    getShopId = () => this.shopId\n    getLocale = () => this.locale\n\n    constructor(\n        clientId: string,\n        environment: Environment,\n        shopId: string,\n        locale: string\n    ){\n        this.clientId = clientId\n        this.environment = environment\n        this.shopId = shopId\n        this.locale = locale\n    }\n    \n    static init = async (clientId: string) => {\n        initListener()\n        const payload: any = await getInit()\n        return new SesamiAdmin(\n            clientId,\n            payload.environment,\n            payload.shopId,\n            payload.locale\n        )\n    }\n\n    getToken = async () => {\n        if(this.token && !isTokenExpired(this.token)){\n            return this.token\n        }else{\n            const token = await getToken(this.clientId)\n            this.token = token as string\n            return token\n        }\n    }\n\n}\n","import { acceptNext, onNext, rejectNext } from './events.app'\nimport { getInit } from './init.app'\nimport { Environment, TeamMember } from '../types'\nimport { initListener } from '../utils'\n\nexport class SesamiExperience {\n\n    private environment: Environment | null = null\n    private shopId: string\n    private locale: string\n    private productId: string | null = null\n    private variantId: string | null = null\n    private quantity: string | null = null\n    private teamMember: TeamMember | null = null\n    private slot: Date | null = null\n\n    getEnvironment = () => this.environment\n    getShopId      = () => this.shopId\n    getLocale      = () => this.locale\n    getProductId   = () => this.productId\n    getVariantId   = () => this.variantId\n    getQuantity    = () => this.quantity\n    getTeamMember  = () => this.teamMember\n    getSlot        = () => this.slot\n\n    constructor(\n        environment: Environment,\n        shopId: string,\n        locale: string,\n        productId: string,\n        variantId: string,\n        quantity: string,\n        teamMember: TeamMember,\n        slot: Date\n    ){\n        this.environment = environment\n        this.shopId = shopId\n        this.locale = locale\n        if(productId ){this.productId  = productId }\n        if(variantId ){this.variantId  = variantId }\n        if(quantity  ){this.quantity   = quantity  }\n        if(teamMember){this.teamMember = teamMember}\n        if(slot      ){this.slot       = slot      }\n    }\n\n    static init = async () => {\n        initListener()\n        const payload: any = await getInit()\n        return new SesamiExperience(\n            payload.environment,\n            payload.shopId,\n            payload.locale,\n            payload.productId,\n            payload.variantId,\n            payload.quantity,\n            payload.teamMember,\n            payload.slot\n        )\n    }\n    \n    onNext = onNext\n    acceptNext = acceptNext\n    rejectNext = rejectNext\n\n}\n","export * from './sesami-admin'\nexport * from './sesami-experience'\n","import { Action, Message } from '../types'\n\nexport const askNext = (iframe: HTMLIFrameElement) => {\n    const data: Message = {\n        action: Action.NEXT\n    }\n    iframe.contentWindow?.postMessage(data)\n    return new Promise(resolve => {\n        window.addEventListener(Action.NEXT, (e: any) => {\n            resolve(e.detail.event.data.payload.isAccepted)\n        })\n    })\n}\n","import { Action, Message, Environment, TeamMember } from '../types'\n\nexport const onInit = (callback: (source: MessageEventSource) => void) => {\n    window.addEventListener(Action.INIT, (e: any) => {\n        callback(e.detail.event.source)\n    })\n}\n\nexport const sendAdminInit = (\n    source: MessageEventSource | null,\n    environment: Environment,\n    shopId: string,\n    locale: string\n) => {\n    const data: Message = {\n        action: Action.INIT,\n        payload: {\n            environment,\n            shopId,\n            locale\n        }\n    }\n    source?.postMessage(data)\n}\n\nexport const sendExperienceInit = (\n    source: MessageEventSource | null,\n    environment: Environment,\n    shopId: string,\n    locale: string,\n    productId: string,\n    variantId: string,\n    quantity: string,\n    teamMember: TeamMember,\n    slot: Date\n) => {\n    const data: Message = {\n        action: Action.INIT,\n        payload: {\n            environment,\n            shopId,\n            locale,\n            productId,\n            variantId,\n            quantity,\n            teamMember,\n            slot\n        }\n    }\n    source?.postMessage(data)\n}\n","import { Action, Message } from '../types'\n\nexport const onGetToken = (callback: (event: MessageEvent<any>) => void) => {\n    window.addEventListener(Action.TOKEN, (e: any) => {\n        callback(e.detail.event)\n    })\n}\n\nexport const sendToken = (event: MessageEvent<any>, token: string) => {\n    const data: Message = {\n        action: Action.TOKEN,\n        payload: {\n            token\n        }\n    }\n    event.source?.postMessage(data)\n}\n","import { askNext } from './events.host'\nimport { onInit, sendAdminInit } from './init.host'\nimport { onGetToken, sendToken } from './authentication.host'\nimport { initListener } from '../utils'\nimport { Environment } from '../types'\n\nexport class AppAdmin {\n\n    private iframe: HTMLIFrameElement\n    private source: MessageEventSource | null = null\n\n    constructor(iframe: HTMLIFrameElement){\n        this.iframe = iframe\n        initListener()\n    }\n\n    onInit = (callback: () => void) => {\n        onInit(source => {\n            this.source = source\n            callback()\n        })\n    }\n\n    sendInit = (\n        environment: Environment,\n        shopId: string,\n        locale: string\n    ) => sendAdminInit(\n        this.source,\n        environment,\n        shopId,\n        locale\n    )\n    \n    onGetToken = onGetToken\n    sendToken = sendToken\n    askNext = () => askNext(this.iframe)\n\n}\n","import { askNext } from './events.host'\nimport { onInit, sendExperienceInit } from './init.host'\nimport { initListener } from '../utils'\nimport { Environment, TeamMember } from '../types'\n\nexport class AppExperience {\n\n    iframe: HTMLIFrameElement\n    source: MessageEventSource | null = null\n\n    constructor(iframe: HTMLIFrameElement){\n        this.iframe = iframe\n        initListener()\n    }\n\n    onInit = (callback: () => void) => {\n        onInit(source => {\n            this.source = source\n            callback()\n        })\n    }\n\n    sendInit = (\n        environment: Environment,\n        shopId: string,\n        locale: string,\n        productId: string,\n        variantId: string,\n        quantity: string,\n        teamMember: TeamMember,\n        slot: Date\n    ) => sendExperienceInit(\n\n        this.source,\n        environment,\n        shopId,\n        locale,\n        productId,\n        variantId,\n        quantity,\n        teamMember,\n        slot\n    )\n    askNext = () => askNext(this.iframe)\n\n}\n","export * from './app-admin'\nexport * from './app-experience'\n"]}